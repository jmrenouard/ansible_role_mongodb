# Ansible Role: mongodb
# File: /defaults/main.yml
# Description: Managed by doc-sync workflow

---
mongodb_repo: true
mongodb_version: 5.0
mongodb_edition: org  # org or enterprise
mongodb_pymongo_version: 4.7.2

# Apply production recommendations, see readme
mongodb_thp: true
mongodb_numa: true

mongodb_admin_pass: 'change_me'
mongodb_adminuser_name: adminuser
mongodb_adminuser_pass: 'change_me'

# --- Defaults for mongod.conf
# See readme

mongodb_net:
  bindIp: 0.0.0.0
  port: 27017

mongodb_systemlog:
  destination: file
  logAppend: true
  path: /var/log/mongodb/mongod.log

mongodb_storage:
  dbPath: /var/lib/mongo
  journal:
    enabled: true

# You should not change the pidfile location
mongodb_processmanagement:
  fork: true
  pidFilePath: /var/run/mongodb/mongod.pid
  timeZoneInfo: /usr/share/zoneinfo

# The keyfile is automatically generated
mongodb_security: ''

mongodb_operationprofiling: ''

mongodb_replication: ''

mongodb_sharding: ''

mongodb_auditlog: ''

mongodb_snmp: ''

mongodb_custom_cnf: ''

# ---

# When replication is desired, the value should either be
# primary, secondary or aribter
# Ensure to include a valid number of nodes, see readme
mongodb_replication_role: ''

# Define databases and users
# See readme for examples
mongodb_user: []

# Backup via cronjob, executed with mongodump
# When there is replication, only active on one secondary
mongodb_backup:
  enabled: true
  dbs:
    - admin
    - config
    - local
  user: backup
  pass: change_me
  path: /var/lib/mongodb_backups
  owner: mongod
  group: mongod
  mode: '0660'
  hour: 2
  minute: 5
  day: "*"
  retention: 46  # in hours

# Restart mongo after a config change
mongodb_restart_config: true

# Amount of seconds before the next mongo instance will be restarted
mongodb_restart_seconds: 15
